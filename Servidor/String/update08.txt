ALTER TABLE PROTOCOLO ADD DATAOCORENCIA DATE;
DROP VIEW VPROTOCOLO;
CREATE VIEW VPROTOCOLO(
  CODIGO,
  CODAPRESENTANTE,
  APRESENTANTE,
  TITULO,
  VENCIMENTO,
  VALORPROTESTO,
  DEVEDOR,
  CPF_CNPJ,
  DATA,
  INTIMACAO,
  COMPRIMENTO,
  CODOCORRENCIA,
  OCORENCIA,
  SEQ,
  FUNCIONARIO,
  FUNCAO,
  MOVIMENTO,
  DATAOCORENCIA)
AS
SELECT
PROTOCOLO.CODIGO,
PROTOCOLO.APRESENTANTE AS CODAPRESENTANTE,
REGISTROCIVIL.NOME AS APRESENTANTE,
TITULOS.NOME AS TITULO,
CADPROTESTO.VENCIMENTO,
CADPROTESTO.VALORPROTESTO,
(SELECT REGISTROCIVIL.NOME FROM REGISTROCIVIL WHERE REGISTROCIVIL.CODIGO = PROTOCOLO.DEVEDOR) AS DEVEDOR,
(SELECT REGISTROCIVIL.CPF_CNPJ FROM REGISTROCIVIL WHERE REGISTROCIVIL.CODIGO = PROTOCOLO.DEVEDOR) AS CPF_CNPJ,
PROTOCOLO.DATA,
PROTOCOLO.INTIMACAO,
PROTOCOLO.COMPRIMENTO,
PROTOCOLO.OCORRENCIA AS CODOCORENCIA,
OCORENCIA.NOME AS OCORENCIA,
PROTOCOLO.SEQ,
FUNCIONARIOS.NOME AS FUNCIONARIO,
FUNCIONARIOS.FUNCAO,
PROTOCOLO.MOVIMENTO,
PROTOCOLO.DATAOCORENCIA
FROM PROTOCOLO
LEFT OUTER JOIN REGISTROCIVIL ON (REGISTROCIVIL.CODIGO = PROTOCOLO.APRESENTANTE)
LEFT OUTER JOIN INTIMACAO ON (INTIMACAO.CODIGO = PROTOCOLO.INTIMACAO)
LEFT OUTER JOIN CADPROTESTO ON (CADPROTESTO.CODIGO = INTIMACAO.PROTESTO)
LEFT OUTER JOIN TITULOS ON (TITULOS.CODIGO = CADPROTESTO.TITULO)
LEFT OUTER JOIN OCORENCIA ON (OCORENCIA.CODIGO = PROTOCOLO.OCORRENCIA)
LEFT OUTER JOIN USUARIOS ON (USUARIOS.CODIGO = PROTOCOLO.USUARIO)
LEFT OUTER JOIN FUNCIONARIOS ON (FUNCIONARIOS.CODIGO = USUARIOS.FUNCIONARIO)
;

ALTER TABLE LANCBOLEINDIVIDUAL ADD CLIENTE INTEGER;
ALTER TABLE LANCBOLEINDIVIDUAL ADD CONSTRAINT FK_LANCBOLEINDIVIDUAL2 FOREIGN KEY (CLIENTE) REFERENCES REGISTROCIVIL(CODIGO);

CREATE VIEW VCAIXABOLINDIVIDUAL(
  VALORTRANSACAO,
  EMOLUMENTOSCARTORIO,
  VLRFERJ,
  VLRFERC,
  CODCLIENTE,
  CLIENTE,
  DATAATO)
AS
SELECT
LANCBOLEINDIVIDUAL.VALORTRANSACAO,
LANCBOLEINDIVIDUAL.VLREMOLUMENTOS - LANCBOLEINDIVIDUAL.VLRFERJ AS EMOLUMENTOSCARTORIO,
LANCBOLEINDIVIDUAL.VLRFERJ,
LANCBOLEINDIVIDUAL.VLRFERC,
LANCBOLEINDIVIDUAL.CLIENTE AS CODCLIENTE,
REGISTROCIVIL.NOME AS CLIENTE,
LANCBOLEINDIVIDUAL.DATAATO
FROM LANCBOLEINDIVIDUAL
LEFT OUTER JOIN REGISTROCIVIL ON (REGISTROCIVIL.CODIGO = LANCBOLEINDIVIDUAL.CLIENTE)
;