CREATE TABLE LANCBOLETIMTOTAL (
  CODIGO INTEGER NOT NULL,
  CODLEI VARCHAR(20),
  EMOLUMENTO INTEGER NOT NULL,
  TIPOSELO INTEGER NOT NULL,
  QUANTIDADE INTEGER,
  SELOINI BIGINT,
  SELOFIM BIGINT,
  EMOLUNIDADE NUMERIC(12, 2),
  VLRFERJ NUMERIC(12, 2),
  VLRFERC NUMERIC(12, 2));
  
  ALTER TABLE LANCBOLETIMTOTAL ADD PRIMARY KEY (CODIGO);
  CREATE GENERATOR GLANCBOLETIMTOTAL;
  SET GENERATOR GLANCBOLETIMTOTAL TO 0;
  CREATE TRIGGER TR_LANCBOLETIMTOTAL FOR LANCBOLETIMTOTAL
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.CODIGO = 0) THEN
      NEW.CODIGO = GEN_ID(GLANCBOLETIMTOTAL, 1);
END;

ALTER TABLE LANCBOLETIMTOTAL ADD CONSTRAINT FK_LANCBOLETIMTOTAL FOREIGN KEY (EMOLUMENTO) REFERENCES EMOLUMENTOS(CODIGO);
ALTER TABLE LANCBOLETIMTOTAL ADD CONSTRAINT FK_LANCBOLETIMTOTAL1 FOREIGN KEY (TIPOSELO) REFERENCES TIPOSELO(CODIGO);

ALTER TABLE LANCBOLETIMTOTAL ADD BOLETIM INTEGER NOT NULL;

ALTER TABLE LANCBOLETIMTOTAL ADD CONSTRAINT FK_LANCBOLETIMTOTAL2 FOREIGN KEY (BOLETIM) REFERENCES BOLETIM(CODIGO);

CREATE VIEW VLANCBOLETIMTOTAL(
  CODIGO,
  CODLEI,
  EMOLUMENTO,
  TIPOATO,
  EMOLUNIDADE,
  QUANTIDADE,
  SELOFIM,
  SELOINI,
  CODTIPOSELO,
  TIPOSELO,
  VLRFERC,
  VLRFERJ,
  BOLETIM)
AS
SELECT
LANCBOLETIMTOTAL.CODIGO,
LANCBOLETIMTOTAL.CODLEI,
LANCBOLETIMTOTAL.EMOLUMENTO,
EMOLUMENTOS.TIPOATO,
LANCBOLETIMTOTAL.EMOLUNIDADE,
LANCBOLETIMTOTAL.QUANTIDADE,
LANCBOLETIMTOTAL.SELOFIM,
LANCBOLETIMTOTAL.SELOINI,
LANCBOLETIMTOTAL.TIPOSELO AS CODTIPOSELO,
TIPOSELO.NOME AS TIPOSELO,
LANCBOLETIMTOTAL.VLRFERC,
LANCBOLETIMTOTAL.VLRFERJ,
LANCBOLETIMTOTAL.BOLETIM
FROM LANCBOLETIMTOTAL
INNER JOIN EMOLUMENTOS ON (EMOLUMENTOS.CODIGO = LANCBOLETIMTOTAL.EMOLUMENTO)
INNER JOIN TIPOSELO ON (TIPOSELO.CODIGO = LANCBOLETIMTOTAL.TIPOSELO)
INNER JOIN BOLETIM ON (BOLETIM.CODIGO = LANCBOLETIMTOTAL.BOLETIM)
;

ALTER TABLE BOLETIM ADD STATUS SMALLINT DEFAULT 0;

CREATE VIEW VBOLETIM(
  CODIGO,
  DATAINI,
  DATAFIM,
  NUMREMESSA,
  NUMBOLETOFERJ,
  DIGVERIFICFERJ,
  DATAPAGFERJ,
  NUMBOLETOFERC,
  DIGVERIFICFERC,
  DATAPAGFERC,
  VLRFERJ,
  VLRFERC,
  CODPAGOFERJ,
  PAGOFERJ,
  CODPAGOFERC,
  PAGOFERC,
  STATUS)
AS
SELECT
  CODIGO,
  DATAINI,
  DATAFIM,
  NUMREMESSA,
  NUMBOLETOFERJ,
  DIGVERIFICFERJ,
  DATAPAGFERJ,
  NUMBOLETOFERC,
  DIGVERIFICFERC,
  DATAPAGFERC,
  VLRFERJ,
  VLRFERC,
  PAGOFERJ AS CODPAGOFERJ,
  CASE PAGOFERJ WHEN 0 THEN 'S'
                WHEN 1 THEN 'N' END PAGOFERJ,
  PAGOFERC AS CODPAGOFERC,
  CASE PAGOFERC WHEN 0 THEN 'S'
                WHEN 1 THEN 'N' END PAGOFERC,
  STATUS
FROM BOLETIM
;