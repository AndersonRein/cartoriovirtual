CREATE TABLE LANCBOLEINDIVIDUAL (
  CODIGO INTEGER NOT NULL,
  CODLEI VARCHAR(20),
  EMOLUMENTO INTEGER NOT NULL,
  NUMATO VARCHAR(20),
  TIPOSELO INTEGER,
  VALORTRANSACAO NUMERIC(12, 2),
  VLREMOLUMENTOS NUMERIC(12, 2),
  SELO BIGINT,
  NUMLIVRO VARCHAR(20),
  NUMFOLHA VARCHAR(20),
  VLRFERJ NUMERIC(12, 2),
  VLRFERC NUMERIC(12, 2),
  DATAATO DATE);
  
  ALTER TABLE LANCBOLEINDIVIDUAL ADD PRIMARY KEY (CODIGO);
  CREATE GENERATOR GLANCBOLEINDIVIDUAL;
  SET GENERATOR GLANCBOLEINDIVIDUAL TO 0;
  CREATE TRIGGER TR_LANCBOLEINDIVIDUAL FOR LANCBOLEINDIVIDUAL
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.CODIGO = 0) THEN
      NEW.CODIGO = GEN_ID(GLANCBOLEINDIVIDUAL, 1);
END;

ALTER TABLE LANCBOLEINDIVIDUAL ADD CONSTRAINT FK_LANCBOLEINDIVIDUAL FOREIGN KEY (EMOLUMENTO) REFERENCES EMOLUMENTOS(CODIGO);

ALTER TABLE LANCBOLEINDIVIDUAL ADD BOLETIM INTEGER NOT NULL;

CREATE TABLE BOLETIM (
  CODIGO INTEGER NOT NULL,
  DATAINI DATE,
  DATAFIM DATE,
  NUMREMESSA VARCHAR(20),
  NUMBOLETOFERJ VARCHAR(20),
  DIGVERIFICFERJ VARCHAR(20),
  DATAPAGFERJ DATE,
  NUMBOLETOFERC VARCHAR(20),
  DIGVERIFICFERC VARCHAR(20),
  DATAPAGFERC DATE,
  VLRFERJ NUMERIC(12, 2),
  VLRFERC NUMERIC(12, 2));
  
  ALTER TABLE BOLETIM ADD PRIMARY KEY (CODIGO);
  CREATE GENERATOR GBOLETIM;
  SET GENERATOR GBOLETIM TO 0;
  CREATE TRIGGER TR_BOLETIM FOR BOLETIM
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.CODIGO = 0) THEN
      NEW.CODIGO = GEN_ID(GBOLETIM, 1);
END;

ALTER TABLE LANCBOLEINDIVIDUAL ADD CONSTRAINT FK_LANCBOLEINDIVIDUAL1 FOREIGN KEY (BOLETIM) REFERENCES BOLETIM(CODIGO);

ALTER TABLE BOLETIM ADD PAGOFERJ SMALLINT;

ALTER TABLE BOLETIM ADD PAGOFERC SMALLINT;

CREATE TABLE TIPOSELO (
  CODIGO INTEGER NOT NULL,
  NOME VARCHAR(100),
  TIPO INTEGER);
  
  ALTER TABLE TIPOSELO ADD PRIMARY KEY (CODIGO);
  CREATE GENERATOR GTIPOSELO;
  SET GENERATOR GTIPOSELO TO 0;
  
  CREATE TRIGGER TR_TIPOSELO FOR TIPOSELO
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.CODIGO = 0) THEN
      NEW.CODIGO = GEN_ID(GTIPOSELO, 1);
END;

CREATE VIEW VLANCBOLEINDIVIDUAL(
  CODIGO,
  BOLETIM,
  CODLEI,
  DATAATO,
  EMOLUMENTO,
  NUMATO,
  NUMFOLHA,
  NUMLIVRO,
  SELO,
  CODTIPOSELO,
  VALORTRANSACAO,
  VLREMOLUMENTOS,
  VLRFERC,
  VLRFERJ,
  TIPOSELO,
  TIPOATO)
AS
SELECT
LANCBOLEINDIVIDUAL.CODIGO,
LANCBOLEINDIVIDUAL.BOLETIM,
LANCBOLEINDIVIDUAL.CODLEI,
LANCBOLEINDIVIDUAL.DATAATO,
LANCBOLEINDIVIDUAL.EMOLUMENTO,
LANCBOLEINDIVIDUAL.NUMATO,
LANCBOLEINDIVIDUAL.NUMFOLHA,
LANCBOLEINDIVIDUAL.NUMLIVRO,
LANCBOLEINDIVIDUAL.SELO,
LANCBOLEINDIVIDUAL.TIPOSELO AS CODTIPOSELO,
LANCBOLEINDIVIDUAL.VALORTRANSACAO,
LANCBOLEINDIVIDUAL.VLREMOLUMENTOS,
LANCBOLEINDIVIDUAL.VLRFERC,
LANCBOLEINDIVIDUAL.VLRFERJ,
TIPOSELO.NOME AS TIPOSELO,
EMOLUMENTOS.TIPOATO
FROM LANCBOLEINDIVIDUAL
INNER JOIN TIPOSELO ON (TIPOSELO.TIPO = LANCBOLEINDIVIDUAL.TIPOSELO)
INNER JOIN EMOLUMENTOS ON (EMOLUMENTOS.CODIGO = LANCBOLEINDIVIDUAL.EMOLUMENTO)
;