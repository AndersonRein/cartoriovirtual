CREATE TABLE REGPESSOAJURIDICA (
  CODIGO INTEGER NOT NULL,
  NOME SMALLINT,
  FICHA INTEGER,
  DATA DATE DEFAULT CURRENT_DATE);
  
  ALTER TABLE REGPESSOAJURIDICA ADD PRIMARY KEY (CODIGO);
  CREATE GENERATOR GREGPESSOAJURIDICA;
  SET GENERATOR GREGPESSOAJURIDICA TO 0;
  CREATE TRIGGER TR_REGPESSOAJURIDICA FOR REGPESSOAJURIDICA
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.CODIGO = 0) THEN
      NEW.CODIGO = GEN_ID(GREGPESSOAJURIDICA, 1);
END;

CREATE TABLE IREGPESSOAJURIDICA (
  CODIGO INTEGER NOT NULL,
  REGPESSOAJURIDICA INTEGER NOT NULL,
  INSCRICAO BLOB SUB_TYPE 1 SEGMENT SIZE 1 NOT NULL);
  ALTER TABLE IREGPESSOAJURIDICA ADD PRIMARY KEY (CODIGO);
  CREATE GENERATOR GIREGPESSOAJURIDICA;
  SET GENERATOR GIREGPESSOAJURIDICA TO 0;
  CREATE TRIGGER TR_IREGPESSOAJURIDICA FOR IREGPESSOAJURIDICA
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.CODIGO = 0) THEN
      NEW.CODIGO = GEN_ID(GIREGPESSOAJURIDICA, 1);
END;

ALTER TABLE IREGPESSOAJURIDICA ADD DATA DATE DEFAULT CURRENT_DATE;
ALTER TABLE IREGPESSOAJURIDICA ADD SELO BIGINT NOT NULL;

CREATE VIEW VINDECEPROTESTO(
  APRESENTANTE,
  TITULO,
  VENCIMENTO,
  VALORPROTESTO,
  DEVEDOR,
  CPF_CNPJ,
  LIVRO,
  FOLHA,
  SITUACAO,
  SELO)
AS
SELECT
REGISTROCIVIL.NOME AS APRESENTANTE,
TITULOS.NOME AS TITULO,
CADPROTESTO.VENCIMENTO,
CADPROTESTO.VALORPROTESTO,
(SELECT REGISTROCIVIL.NOME FROM REGISTROCIVIL WHERE REGISTROCIVIL.CODIGO = CADPROTESTO.DEVEDOR) AS DEVEDOR,
(SELECT REGISTROCIVIL.CPF_CNPJ FROM REGISTROCIVIL WHERE REGISTROCIVIL.CODIGO = CADPROTESTO.DEVEDOR) AS CPF_CNPJ,
1 LIVRO,
PROTOCOLO.SEQ AS FOLHA,
OCORENCIA.NOME AS SITUACAO,
PROTESTO.SELO
FROM CADPROTESTO
INNER JOIN REGISTROCIVIL ON (REGISTROCIVIL.CODIGO = CADPROTESTO.APRESENTANTE)
INNER JOIN PROTESTO ON  (PROTESTO.CADPROTESTO = CADPROTESTO.CODIGO)
INNER JOIN TITULOS ON (TITULOS.CODIGO = CADPROTESTO.TITULO)
INNER JOIN PROTOCOLO ON (PROTOCOLO.CODIGO = CADPROTESTO.PROTOCOLO)
LEFT OUTER JOIN OCORENCIA ON (OCORENCIA.CODIGO = PROTOCOLO.OCORRENCIA)
;
ALTER TABLE IREGPESSOAJURIDICA ADD VALOR NUMERIC(12, 2) DEFAULT 0;
ALTER TABLE CONFIGURACOES ADD RODAPEPJURIDICA VARCHAR(500);
ALTER TABLE IREGPESSOAJURIDICA ADD RODAPE VARCHAR(500);
ALTER TABLE IREGPESSOAJURIDICA ADD SEQ SMALLINT;